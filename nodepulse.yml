# NodePulse Agent Configuration

server:
  # The endpoint to send metrics to
  endpoint: "https://ingest.dogfooding.nodepulse.sh"

  # HTTP request timeout
  # If the server doesn't respond within this time, the request fails
  # and the buffered report will be retried later
  timeout: 3s

agent:
  # Unique server ID (UUID format)
  # If not set or left as placeholder, a UUID will be auto-generated on first run
  # and saved to /var/lib/node-pulse/server_id for persistence
  # You can also manually set one: uuidgen (Linux/Mac) or New-Guid (PowerShell)
  server_id: "00000000-0000-0000-0000-000000000000"

  # Metrics collection interval
  # Allowed values: 5s, 10s, 30s, 1m
  interval: 5s

buffer:
  # Directory to store buffered reports
  # All metrics are buffered first (Write-Ahead Log pattern)
  # Each collection creates one JSON file (e.g., 20251020-143045.json)
  # Background process sends buffered data with random jitter to distribute load
  path: "/var/lib/node-pulse/buffer"

  # How long to keep buffered reports (in hours)
  # Files older than this are automatically deleted
  retention_hours: 48

  # Number of reports to send per batch request
  # Higher values = fewer HTTP requests, larger payloads
  # Default: 5
  batch_size: 5

logging:
  # Log level: debug, info, warn, error
  # debug: Verbose diagnostic information for troubleshooting
  # info: General informational messages about normal operation
  # warn: Potentially harmful situations that don't prevent operation
  # error: Error events that might still allow operation to continue
  level: "info"

  # Log output destination: stdout, file, both
  # stdout: Output to console/terminal
  # file: Write to log file with rotation
  # both: Output to both console and file
  output: "stdout"

  # File logging configuration (used when output is "file" or "both")
  file:
    # Path to the log file
    path: "/var/log/node-pulse/agent.log"

    # Maximum size in MB before rotating
    max_size_mb: 10

    # Maximum number of old log files to keep
    max_backups: 3

    # Maximum number of days to keep old log files
    max_age_days: 7

    # Compress rotated log files with gzip
    compress: true
